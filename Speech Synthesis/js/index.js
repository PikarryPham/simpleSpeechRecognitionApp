const msg=new SpeechSynthesisUtterance;let voices=[];const voicesDropdown=document.querySelector('[name="voice"]'),options=document.querySelectorAll('[type="range"], [name="text"]'),speakButton=document.querySelector("#speak"),stopButton=document.querySelector("#stop");msg.text=document.querySelector('[name="text"]').value;const body=document.querySelector("body");function populateVoices(){voices=this.getVoices(),voicesDropdown.innerHTML=voices.filter(e=>e.lang.includes("en")).map(e=>`<option value="${e.name}">${e.name} (${e.lang})</option>`).join("")}function setVoice(){msg.voice=voices.find(e=>e.name===this.value),toggle()}function toggle(e=!0){speechSynthesis.cancel(),e?(speechSynthesis.speak(msg),body.style.background="url(img/wave.gif)",body.style.backgroundRepeat="repeat-x",body.style.backgroundSize="100% 100%"):body.style.background=""}function setOption(){console.log(this.name,this.value),msg[this.name]=this.value,"rate"==this.name?document.getElementById("voice_range").innerHTML=this.value:"pitch"==this.name&&(document.getElementById("voice_pitch").innerHTML=this.value),toggle()}speechSynthesis.addEventListener("voiceschanged",populateVoices),voicesDropdown.addEventListener("change",setVoice),options.forEach(e=>e.addEventListener("change",setOption)),speakButton.addEventListener("click",toggle),stopButton.addEventListener("click",()=>toggle(!1));